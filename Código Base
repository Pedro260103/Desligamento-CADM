Sub SEFIP()
 Dim LocaldoArquivo como String
 Dim NumArquivo como inteiro
 Dim FileContent como cadeia de caracteres
    Dim Linha As String
     
    
    LocaldoArquivo = "C:\Users\pres00314250\Desktop\arquivo_aprender.txt"
    NumArquivo = FreeFile
    
 Abra LocaldoArquivo For Input As #NumArquivo ' Abre o arquivo em modo de leitura
    
    FileContent = Input$(LOF(1), #NumArquivo)
 Fechar #NumArquivo
 
    ' Extrai informações da linha
    Linha = Trim(FileContent) ' Remove espaços em branco no início e no fim
 
 Dim Codigo como corda
 Dim Pis como corda
    Dim nome As String
 Dim DataAdimissao como String
 Dim Codigo20 Como Corda
 Dim CodigoDesligamento Como Corda
 Dim bm como corda
 Dim DataNacimento Como String
 Dim DataDemissão como cadeia de caracteres
 Dim NovoConteudo Como Corda
    Dim linhas() As String
 Dim UltimaLinha Como Inteiro ' longlong
    Dim contador As LongLong
    contador = 2
    linhas = Split(FileContent, vbCrLf)
    UltimaLinha = UBound(linhas)
    
    
 Do While Range("A" & contador). Valor <> ""
 bm = Intervalo("A" & contador). Valor
 bm = Substituir(bm, "-", "")
        
 Para i = 747 Para UBound(linhas)
 Codigo = Médio (linhas(i), 1, 18)
            Pis = Mid(linhas(i), 33, 11) ' Ajuste para 11 caracteres
            nome = Mid(linhas(i), 54, 70) ' Ajuste para 30 caracteres
            DataAdmissao = Mid(linhas(i), 44, 8) ' Extrai a DataAdmissao corretamente
 Codigo20 = Médio (linhas(i), 48, 2)
 DataDemissao = Range("D" & contador). Valor
 DataDemissao = Substituir(DataDemissão, "/", "")
 CodigoDesligamento = MotivoDesligamentoCodigo(DataDemissão, contador) 'MotivoDesligamentoCodigo(DataDemissão, contador)
 DataNacimento = Médio (linhas(i), 155, 8)
 Codigo = Esquerda(Codigo, 1) & "2" & Direita(Codigo, Len(Codigo) - 2)
        
 Se InStr(1, linhas(i), bm, vbTextCompare) > 0 Então 'E CodigosNullosDesligamento(linhas, i + 1) = True Então
        
        
            MsgBox "Valor encontrado na posição " & i
      
            
            ' Exibe as informações extraídas
            MsgBox "Código: " & Codigo & vbCrLf & "Pis: " & Pis & vbCrLf & "Nome: " & nome & vbCrLf & "DataAdmissao: " & DataAdmissao & vbCrLf & "DataDemissao: " & DataDemissao & vbCrLf & "Codigo20: " & Codigo20 & vbCrLf & "BM: " & bm & vbCrLf & "DataNacimento: " & DataNacimento
    
            ' Crie o novo conteúdo com as informações modificadas
            NovoConteudo = Codigo & Space(14) & Mid(Pis & Space(11), 1, 11) & Mid(DataAdmissao & Space(8), 1, 8) & Codigo20 & Mid(nome & Space(70), 1, 70) & Mid(CodigoDesligamento, 1, 11) & Space(226) & "*"
 'Se BM = Médio (Linha, 124, 11) então
            'NovoConteudo = Linha & vbCrLf & NovoConteudo
 «Acabar se
          
            Dim OriginalConteudo As String
 Conteúdo original = linhas(i)
 Dim i2 como inteiro
            i2 = UltimaLinha
            ReDim Preserve linhas(UBound(linhas))
            linhas(UBound(linhas)) = "                                                                                                                                                                                                                                                                                                                                                                        "
            Dim c As Integer
            c = 1
 Dim bmTXT como cadeia de caracteres
 bmTXT = Médio (linhas(i + 1), 124, 2)
 Faça enquanto bmTXT <> "00"
                c = c + 1
 bmTXT = Médio(linhas(i + c), 124, 2)
                
 Laço
 « Atualiza a linha no array
                ' Adiciona uma linha em branco ao final do array
 Fazer enquanto i2 >= i
                    linhas(i2) = linhas(i2 - 1)
                    i2 = i2 - 1
 Laço
 linhas(i) = OriginalConteúdo
 linhas(i + c) = Novo Conteúdo
                
            ' Reescreve o arquivo com o conteúdo atualizado
 Abra LocaldoArquivo para saída como #NumArquivo
            Print #NumArquivo, Join(linhas, vbCrLf) ' Converte o array de volta para uma única string com linhas separadas por vbCrLf
 Fechar #NumArquivo
    
    
    
 ' Substitui a linha anterior pelo NovoConteúdo
 'FileContent = Substituir(FileContent, linhas(i), NovoConteudo)
            ' Abre o arquivo em modo de adição (Append) para adicionar o novo conteúdo ao final do arquivo
 'Abra LocaldoArquivo para anexar como #NumArquivo 'Anexar
 « Imprimir #NumArquivo, NovoConteúdo
 'Fechar #NumArquivo
     
            
                
            contador = contador + 1 ' para na planilha passar para o BM de baixo
 Se eu > 1 Então
              i = 3
 Fim Se
             
             
 'ElseIf CodigosNullosDesligamento(linhas, i + 1) = Falso Então ' Acho que não precisa do else
            
            
             
            
            
 Fim Se
     
 Seguinte i
 Laço

Subfinal



Dim i2 como inteiro
            i2 = UltimaLinha
            ReDim Preserve linhas(UBound(linhas))
            linhas(UBound(linhas)) = "                                                                                                                                                                                                                                                                                                                                                                        "
            'Dim c As Integer
            'c = 1
 'Dim bmTXT como corda
 'bmTXT = Médio(linhas(i + 1), 124, 2)
            
            'Do While bmTXT <> "00"
             '   c = c + 1
 ' bmTXT = Médio(linhas(i + c), 124, 2)
                
 « Laço
 « Atualiza a linha no array
                ' Adiciona uma linha em branco ao final do array
                Do While i2 >= i 'InStr(1, linhas(i2), nome, vbTextCompare) = 0
 Dim PisTXT como corda
 PisTXT = Médio(linhas(i2 - 1), 33, 11)
 Se PisTXT = Pis então
 linhas(i2) = Novo Conteúdo
                        
 Mais
                        linhas(i2) = linhas(i2 - 1)
                        i2 = i2 - 1
                        
 Fim Se
                    
                    
 Laço
 'linhas(i - 1) = OriginalConteúdo
                
            ' Reescreve o arquivo com o conteúdo atualizado
 Abra LocaldoArquivo para saída como #NumArquivo
            Print #NumArquivo, Join(linhas, vbCrLf) ' Converte o array de volta para uma única string com linhas separadas por vbCrLf
 Fechar #NumArquivo































'demanda urgente


Sub grava()
 Dim LocalDoArquivo como sequência de caracteres
 Dim NumArquivo como inteiro
 Dim FileContent como cadeia de caracteres
    Dim Linha As String
    LocalDoArquivo = "C:\Users\pres00314250\Desktop\arquivo_aprender.txt"
    NumArquivo = FreeFile
    
 Abra LocalDoArquivo para entrada como #NumArquivo

    FileContent = Input$(LOF(1), #NumArquivo)
 Fechar #NumArquivo
    
    
    Linha = Trim(FileContent)
    
 Dim SegundaInfo Como String
    Dim Nome As String
 Dim NomeFlutuante Como String
 Dim BM como corda
 Dim eUmBM como corda
 Dim NovoConteudo Como Corda
 Dim PrimeiraInfo Como String
    Dim linhas() As String
    Dim MudaPessoa As LongLong
    MudaPessoa = 0
 Dim puladas como LongLong
    puladas = 0
    linhas = Split(FileContent, vbCrLf)
    
    
    
    
    
    Dim contador As Integer
    contador = 1
 Para i = 3 a 9510 'UBound(linhas)
 Nome = Médio(linhas(i), 54, 70)
 BM = Médio (linhas(i), 124, 11)
 eUmBM = Médio (linhas(i), 124, 2)
        
 If InStr(1, linhas(i), eUmBM, vbTextCompare) > 0 E eUmBM = "00" Então ' ficou meio redundante
            puladas = puladas + 1
 Se InStr(1, linhas(i + 1), eUmBM, vbTextCompare) <> BM então
                MudaPessoa = MudaPessoa + 1
                contador = 1
 Fim Se
            
            
 Mais
            
 NomeFlutuante = Médio(linhas(i + 1), 54, 70)
 Se eUmBM = "I3" ou eUmBM = "I1" ou eUmBM = " J" Então
                
 « MsgBox "Achamos o I3N , I1N , J"
                PrimeiraInfo = Mid(linhas(i - contador), 1, 244)
                SegundaInfo = Mid(linhas(i - contador), 245, 116)
 « MsgBox SegundaInfo
 SegundaInfo = Esquerda(SegundaInfo, 1) & "1" & Direita(SegundaInfo, Len(SegundaInfo) - 2)
 NovoConteúdo = PrimeiraInfo + SegundaInfo
 « MsgBox NovoConteudo
                ' Abre o arquivo em modo de leitura e escrita
 Abra LocalDoArquivo para entrada como #NumArquivo
                FileContent = Input$(LOF(1), #NumArquivo)
 Fechar #NumArquivo
                
 ' Substitui a linha anterior pelo NovoConteúdo
                FileContent = Replace(FileContent, linhas(i - contador), NovoConteudo)
                
                ' Abre o arquivo em modo de escrita para gravar as alterações
 Abra LocalDoArquivo para saída como #NumArquivo
 Imprimir #NumArquivo, FileContent
 Fechar #NumArquivo
                contador = 1
 Mais
            
            
            
            contador = contador + 1
            
            
            
 Fim Se
                
            
            
            
            
 Fim Se
    
 Seguinte i
    
MsgBox "Fim!"
Subfinal
